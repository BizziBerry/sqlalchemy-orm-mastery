# üêç SQLAlchemy ORM Mastery

<div align="center">

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![SQLAlchemy](https://img.shields.io/badge/SQLAlchemy-2.0+-red.svg)  
![SQLite](https://img.shields.io/badge/SQLite-3.0+-green.svg)
![Alembic](https://img.shields.io/badge/Alembic-Migrations-orange.svg)

![ORM](https://img.shields.io/badge/ORM-Patterns-ff6b35.svg)
![Database](https://img.shields.io/badge/Database-Design-6495ed.svg)
![Migrations](https://img.shields.io/badge/Transactions-Safe-32cd32.svg)
![Performance](https://img.shields.io/badge/Performance-Optimized-ffd700.svg)

 **–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ SQLAlchemy ORM —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏ –∏ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏**

</div>


## ‚úÖ –ó–∞–¥–∞—á–∞ 1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –°–æ–∑–¥–∞—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ Author –∏ Book (–æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–µ–Ω–∏–≤—É—é –∏ –∂–∞–¥–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É
- –°—Ä–∞–≤–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤

### üîß –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
–ú–æ–¥–µ–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –≤ ```models.py```:

```
python
class Author(Base):
    __tablename__ = 'authors'
    id = Column(Integer, primary_key=True, index=True)
    name = Column(String(100), nullable=False)
    books = relationship("Book", back_populates="author")

class Book(Base):
    __tablename__ = 'books'
    id = Column(Integer, primary_key=True, index=True)
    title = Column(String(200), nullable=False)
    author_id = Column(Integer, ForeignKey('authors.id'))
    author = relationship("Author", back_populates="books")
```
### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏:

**–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞:**
```
text
Zapros 1: SELECT authors.id, authors.name FROM authors
Zapros 2: SELECT books.id, books.title, books.author_id FROM books WHERE books.author_id = ?
Zapros 3: SELECT books.id, books.title, books.author_id FROM books WHERE books.author_id = ?
VSEGO ZAPROSOV: 3

```
***–ñ–∞–¥–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞:***
```
text
Zapros 1: SELECT authors.id, authors.name, books_1.id, books_1.title, books_1.author_id 
          FROM authors LEFT OUTER JOIN books AS books_1 ON authors.id = books_1.author_id
VSEGO ZAPROSOV: 1
```

### üéØ –í—ã–≤–æ–¥—ã:
- ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ N+1 –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞: –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç 3 –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è 2 –∞–≤—Ç–æ—Ä–æ–≤
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞: –ñ–∞–¥–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤ 3 —Ä–∞–∑–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –∏ —Å–æ–∫—Ä–∞—â–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –¥–æ 1
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –í 3 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î

### üè† –°–æ–∑–¥–∞–Ω—ã —Å–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ Author –∏ Book
![–°–æ–∑–¥–∞–Ω—ã —Å–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ Author –∏ Book](screenshots/1_Author_Book.jpg)

### üè† –õ–µ–Ω–∏–≤–∞—è –∏ –∂–∞–¥–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
![–õ–µ–Ω–∏–≤–∞—è –∏ –∂–∞–¥–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞](screenshots/1_lazy_Eager.jpg)

### üè† –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–æ–∫
![–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–æ–∫](screenshots/1_compare.jpg)

## ‚úÖ –ó–∞–¥–∞—á–∞ 2: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –æ—Ç–∫–∞—Ç—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É User
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –æ—Ç–∫–∞—Ç–æ–º –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

### üîß –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
–ö–æ–¥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ ```transactions.py```:
```
python
def transaction_with_rollback():
    try:
        user1 = User(username="user1", email="user1@example.com")
        user2 = User(username="user2", email="user2@example.com")
        user3 = User(username="user1", email="user3@example.com")  # –î—É–±–ª–∏–∫–∞—Ç!
        
        session.add_all([user1, user2, user3])
        session.commit()
    except SQLAlchemyError as e:
        session.rollback()
        print("‚úÖ Tranzakciya otkatilas pri oshibke!")
```

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
**–£—Å–ø–µ—à–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è:**
```
text
‚úÖ Tranzakciya uspeshno zavershena
Dobavleny: charlie, david

```
**–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å –æ—à–∏–±–∫–æ–π:**
```
text
‚ùå Popytka dobavit alice (dublikat)
‚úÖ Tranzakciya otkatilas pri oshibke!
Oshibka: UNIQUE constraint failed: users.username
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –æ—Ç–∫–∞—Ç–∞:**
```
text
Polzovatelej v baze: 4
Spisok polzovatelej:
  - alice (alice@example.com)
  - bob (bob@example.com)
  - charlie (charlie@example.com)
  - david (david@example.com)
```

### üéØ –í—ã–≤–æ–¥—ã:
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ: BEGIN/COMMIT/ROLLBACK –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è
- ‚úÖ –û—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ - –≤–∏–¥–Ω–æ ROLLBACK –ø–æ—Å–ª–µ –ø–æ–ø—ã—Ç–∫–∏ –¥–æ–±–∞–≤–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç 'alice'
- ‚úÖ –û—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö: –ü—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ UNIQUE constraint —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è
- ‚úÖ –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö: –ü–æ—Å–ª–µ –æ—Ç–∫–∞—Ç–∞ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –≤ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 'eve' –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç: –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ —á—Ç–æ –æ—Ç–∫–∞—Ç —Å—Ä–∞–±–æ—Ç–∞–ª

### üè† –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –æ—Ç–∫–∞—Ç—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π
![–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –æ—Ç–∫–∞—Ç—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π](screenshots/2.jpg)


## ‚úÖ –ó–∞–¥–∞—á–∞ 3: –†–∞–±–æ—Ç–∞ —Å Alembic

### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Alembic
- –°–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã Order
- –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É (–¥–æ–±–∞–≤–∏—Ç—å price, —É–¥–∞–ª–∏—Ç—å created_at)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–π

### üîß –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:

**–ò—Å—Ç–æ—Ä–∏—è –º–∏–≥—Ä–∞—Ü–∏–π:**
```
text
b45f9bf9740c -> b5325bb30894 (head), Orders table with price and created_at
8e3888d1cd7a -> b45f9bf9740c, Add price and remove created_at from orders
<base> -> 8e3888d1cd7a, Create orders table
```
**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```
text
Struktura tablicy orders:
  - id: INTEGER
  - product_name: VARCHAR(100)
  - quantity: INTEGER
  - created_at: DATETIME
  - price: FLOAT
```  
**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è created_at:**
```
text
Struktura tablicy orders posle udaleniya created_at:
  - id: INTEGER
  - product_name: VARCHAR(100)
  - quantity: INTEGER
  - price: FLOAT
```  
**–û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏:**
```
text
INFO  [alembic.runtime.migration] Running downgrade be2f54d63811 -> b5325bb30894
INFO  [sqlalchemy.engine.Engine] ALTER TABLE orders ADD COLUMN created_at DATETIME
```

### üéØ –í—ã–≤–æ–¥—ã:
- ‚úÖ Alembic –Ω–∞—Å—Ç—Ä–æ–µ–Ω: –ú–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: –ü–æ–ª–µ price –¥–æ–±–∞–≤–ª–µ–Ω–æ, created_at —É–¥–∞–ª–µ–Ω–æ
- ‚úÖ –û—Ç–∫–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç: alembic downgrade -1 —É—Å–ø–µ—à–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- ‚úÖ –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è: Alembic –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª—è—Ö

### üè† Alembic –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
![Alembic –Ω–∞—Å—Ç—Ä–æ–µ–Ω](screenshots/3_alembic_migration.jpg)

### üè† –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:+ price (FLOAT) - created_at (DATETIME)
![+ price (FLOAT) - created_at (DATETIME)](screenshots/3_float_datetime.jpg)


## ‚úÖ –ó–∞–¥–∞—á–∞ 4: –ü–∞—Ç—Ç–µ—Ä–Ω Repository

### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Repository –¥–ª—è –º–æ–¥–µ–ª–∏ Book
- –°–æ–∑–¥–∞—Ç—å —Ñ–∞–±—Ä–∏–∫—É —Å–µ—Å—Å–∏–π
- –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### üîß –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:

Repository –≤ ```repositories.py```:
```
python
class BookRepository:
    def add_book(self, title: str, author_id: int) -> Book
    def get_books_by_author(self, author_id: int) -> List[Book]
    def delete_book(self, book_id: int) -> bool
    def get_all_books(self) -> List[Book]

class RepositoryFactory:
    @staticmethod
    def get_book_repository(db: Session) -> BookRepository
```

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
```
text
=== TESTIRUEM REPOSITORY PATTERN ===
1. Poluchaem vse knigi:
   Vsego knig: 4
2. Poluchaem knigi avtora (ID: 1):
   Knig u avtora: 2
     - –í–æ–π–Ω–∞ –∏ –º–∏—Ä
     - –ê–Ω–Ω–∞ –ö–∞—Ä–µ–Ω–∏–Ω–∞
3. Udalaem knigu:
   Rezultat udaleniya: True
4. Proverka posle udaleniya:
   Ostalos knig: 1
```   
### üéØ –í—ã–≤–æ–¥—ã:
1. ‚úÖ Repository –ø–∞—Ç—Ç–µ—Ä–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω:
-```BookRepository``` —Å –º–µ—Ç–æ–¥–∞–º–∏ CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- ```RepositoryFactory``` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
2. ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
- ```get_all_books()``` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–Ω–∏–≥ (4 –∫–Ω–∏–≥–∏)
- ```get_books_by_author(1)``` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–Ω–∏–≥ –∞–≤—Ç–æ—Ä–∞ (2 –∫–Ω–∏–≥–∏)
- ```delete_book(1)``` - —É–¥–∞–ª–µ–Ω–∏–µ –∫–Ω–∏–≥–∏ (—É—Å–ø–µ—à–Ω–æ)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è (–æ—Å—Ç–∞–ª–∞—Å—å 1 –∫–Ω–∏–≥–∞)
3. ‚úÖ –§–∞–±—Ä–∏–∫–∞ —Å–µ—Å—Å–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç:
- –°–µ—Å—Å–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ:
- –í—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ä–∞–±–æ—Ç—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å


### üè†  –ü–∞—Ç—Ç–µ—Ä–Ω **Repository** –¥–ª—è –º–æ–¥–µ–ª–∏ `Book` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
![–ü–∞—Ç—Ç–µ—Ä–Ω **Repository** –¥–ª—è –º–æ–¥–µ–ª–∏ `Book` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω](screenshots/4.jpg)


## ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –ê–Ω–∞–ª–∏–∑ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏
- –û–±—ä–µ–¥–∏–Ω–∏—Ç—å ORM –∏ Core –≤ –æ–¥–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ

### üîß –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:

**–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∑–∞–≥—Ä—É–∑–∫–∏:**
1. –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞: 3 –∑–∞–ø—Ä–æ—Å–∞ (–ø—Ä–æ–±–ª–µ–º–∞ N+1)
2. –ñ–∞–¥–Ω–∞—è —Å JOIN: 1 –∑–∞–ø—Ä–æ—Å (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ)
3. –ñ–∞–¥–Ω–∞—è —Å SELECT IN: 2 –∑–∞–ø—Ä–æ—Å–∞ (–∫–æ–º–ø—Ä–æ–º–∏—Å—Å)

**SQLAlchemy Core –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:**
```
sql
SELECT 
    a.name as author_name,
    COUNT(b.id) as book_count,
    AVG(LENGTH(b.title)) as avg_title_length
FROM authors a
LEFT JOIN books b ON a.id = b.author_id
GROUP BY a.id, a.name
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:**
```
text
Avtor: –§–µ–¥–æ—Ä –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π
  Kollichestvo knig: 2
  Srednjaja dlina nazvanija: 14.5 simvolov

Avtor: –õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π
  Kollichestvo knig: 1  
  Srednjaja dlina nazvanija: 13.0 simvolov
```

### üéØ –í—ã–≤–æ–¥—ã:
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ: –í—Å–µ SQL-–∑–∞–ø—Ä–æ—Å—ã –≤–∏–¥–Ω—ã –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã
- ‚úÖ –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã: JOIN —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞
- ‚úÖ Core –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
- ‚úÖ –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥: ORM –¥–ª—è CRUD, Core –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ - –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ



### üè†  –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤
![–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤](screenshots/5_log.jpg)
### üè†  –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∑–∞–≥—Ä—É–∑–∫–∏
![–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∑–∞–≥—Ä—É–∑–∫–∏](screenshots/5_an.jpg)
### üè†  SQLAlchemy Core –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
![SQLAlchemy Core –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤](screenshots/5_SQLAlchemy Core.jpg)
### üè†  –°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ORM –∏ Core
![–°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ORM –∏ Core](screenshots/5_ORM_Core.jpg)


## üèÜ –ò—Ç–æ–≥–æ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

### üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤: —Å 3 –¥–æ 1 —á–µ—Ä–µ–∑ –∂–∞–¥–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É (67% —É–ª—É—á—à–µ–Ω–∏–µ)
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏: –º–µ–Ω—å—à–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Core
- –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏: —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è:
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: Repository pattern –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å: Alembic –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π —Å—Ö–µ–º—ã –ë–î
- –ì–∏–±–∫–æ—Å—Ç—å: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ORM –∏ Core –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### üéØ –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å:
- –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å: –°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –æ—à–∏–±–∫–∞–º –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å: –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Ç–∞–±–ª–∏—Ü—ã

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
text
project/
‚îú‚îÄ‚îÄ models.py              # –ú–æ–¥–µ–ª–∏ SQLAlchemy
‚îú‚îÄ‚îÄ database.py            # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î –∏ —Å–µ—Å—Å–∏–π
‚îú‚îÄ‚îÄ repositories.py        # Repository –ø–∞—Ç—Ç–µ—Ä–Ω
‚îú‚îÄ‚îÄ transactions.py        # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
‚îú‚îÄ‚îÄ tests.py               # –¢–µ—Å—Ç—ã Repository
‚îú‚îÄ‚îÄ optimization.py        # –ê–Ω–∞–ª–∏–∑ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ lazy_vs_eager.py       # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
‚îú‚îÄ‚îÄ check_models.py        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ check_queries.py       # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ alembic/               # –ú–∏–≥—Ä–∞—Ü–∏–∏ Alembic
‚îî‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```
